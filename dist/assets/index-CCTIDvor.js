const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-l2-y3o7m.js","assets/home-BMI35RZU.js","assets/Sync-CrPe6vuD.js"])))=>i.map(i=>d[i]);
import{_ as e,r as n}from"./home-BMI35RZU.js";import{r as t}from"./vendor-vIG-nS3h.js";import{a}from"./news-DDvVS8Nc.js";import{r as o}from"./projects-Xr_gWjfg.js";import{renderAbout as r}from"./about-CDI6OUSm.js";function i(n,t){if(!(t&&t.username))return n.innerHTML='\n      <div style="text-align: center; padding: 60px 20px;">\n        <div style="font-size: 96px; margin-bottom: 24px;">ğŸ“</div>\n        <h1 style="font-size: 36px; font-weight: 800; margin: 0 0 16px 0; color: var(--text);">\n          Perfil de Usuario\n        </h1>\n        <p style="color: var(--muted); font-size: 18px; margin: 0 0 32px 0; max-width: 500px; margin: 0 auto 32px auto;">\n          Accede a tu cuenta para personalizar tu experiencia y acceder a funciones exclusivas\n        </p>\n        \n        <div style="background: linear-gradient(135deg, var(--card), var(--panel)); border-radius: var(--radius); padding: 32px; border: 1px solid var(--border); max-width: 400px; margin: 0 auto; box-shadow: var(--shadow);">\n          <h3 style="margin-top: 0; color: var(--text);">ğŸ”‘ Iniciar SesiÃ³n</h3>\n          <p style="color: var(--muted); margin-bottom: 24px;">\n            Inicia sesiÃ³n para acceder a todas las funcionalidades del portal educativo\n          </p>\n          <button id="open-login-btn" class="btn-publicar" style="width: 100%; font-size: 16px;">\n            ğŸš€ Iniciar SesiÃ³n\n          </button>\n        </div>\n        \n        <div style="margin-top: 40px; padding: 24px; background: rgba(255,255,255,0.03); border-radius: var(--radius); border: 1px solid var(--border); max-width: 600px; margin: 40px auto 0;">\n          <h4 style="margin-top: 0; color: var(--text);">ğŸ¯ Â¿QuÃ© puedes hacer al iniciar sesiÃ³n?</h4>\n          <div style="display: grid; gap: 16px; text-align: left;">\n            <div style="display: flex; gap: 12px; align-items: center;">\n              <span style="font-size: 24px;">ğŸ’¬</span>\n              <div>\n                <strong style="color: var(--text);">Comentar publicaciones</strong>\n                <div style="color: var(--muted); font-size: 14px;">Participa en conversaciones sobre noticias y proyectos</div>\n              </div>\n            </div>\n            <div style="display: flex; gap: 12px; align-items: center;">\n              <span style="font-size: 24px;">â¤ï¸</span>\n              <div>\n                <strong style="color: var(--text);">Dar "me gusta"</strong>\n                <div style="color: var(--muted); font-size: 14px;">Muestra tu apoyo a los contenidos que te interesan</div>\n              </div>\n            </div>\n            <div style="display: flex; gap: 12px; align-items: center;">\n              <span style="font-size: 24px;">ğŸ””</span>\n              <div>\n                <strong style="color: var(--text);">Recibir notificaciones</strong>\n                <div style="color: var(--muted); font-size: 14px;">Mantente al dÃ­a con las Ãºltimas actualizaciones</div>\n              </div>\n            </div>\n            <div style="display: flex; gap: 12px; align-items: center;">\n              <span style="font-size: 24px;">ğŸ‘¨â€ğŸ’¼</span>\n              <div>\n                <strong style="color: var(--text);">Funciones de administrador</strong>\n                <div style="color: var(--muted); font-size: 14px;">Si eres admin: crear, editar y gestionar contenido</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ',void(n.querySelector("#open-login-btn").onclick=()=>{e(()=>import("./login-l2-y3o7m.js"),__vite__mapDeps([0,1])).then(e=>{e.renderLogin(n)})});const a=t.loginTime?new Date(t.loginTime):null,o="admin"===t.role;n.innerHTML=`\n    <div style="max-width: 800px; margin: 0 auto;">\n      <div style="text-align: center; margin-bottom: 40px;">\n        <div style="display: inline-block; width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--accent-2)); display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: 800; margin-bottom: 20px; box-shadow: var(--shadow-lg); border: 4px solid var(--white);">\n          ${s(t.avatar||t.username[0].toUpperCase())}\n        </div>\n        <h1 style="font-size: 36px; font-weight: 800; margin: 0 0 8px 0; color: var(--text);">\n          ${o?"ğŸ‘¨â€ğŸ’¼":"ğŸ“"} ${s(t.username)}\n        </h1>\n        <div style="color: var(--muted); font-size: 18px;">\n          ${o?"Administrador del Sistema":"Miembro de la Comunidad"}\n        </div>\n        ${a?`\n          <div style="color: var(--muted); font-size: 14px; margin-top: 8px;">\n            ğŸ•’ Ãšltima sesiÃ³n: ${function(e){if(!e)return"";try{return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(n){return""}}(t.loginTime)}\n          </div>\n        `:""}\n      </div>\n\n      <div style="display: grid; gap: 24px;">\n        \x3c!-- User Stats --\x3e\n        <div style="background: linear-gradient(135deg, var(--card), var(--panel)); border-radius: var(--radius); padding: 24px; border: 1px solid var(--border); box-shadow: var(--shadow);">\n          <h3 style="margin-top: 0; color: var(--text); display: flex; align-items: center; gap: 8px;">\n            <span>ğŸ“Š</span> Tu Actividad\n          </h3>\n          ${function(e){const n=JSON.parse(localStorage.getItem("posts")||"[]");n.filter(n=>n.author===e.username||"admin"===e.role);const t=n.reduce((e,n)=>e+(n.likes||0),0),a=n.reduce((e,n)=>e+(n.comments||[]).length,0);return`\n    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">\n      <div style="text-align: center; padding: 16px; background: rgba(37,99,235,0.1); border-radius: var(--radius-sm); border: 1px solid rgba(37,99,235,0.2);">\n        <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“</div>\n        <div style="font-size: 24px; font-weight: 700; color: var(--text);">${n.length}</div>\n        <div style="color: var(--muted); font-size: 14px;">Publicaciones Totales</div>\n      </div>\n      \n      <div style="text-align: center; padding: 16px; background: rgba(220,38,38,0.1); border-radius: var(--radius-sm); border: 1px solid rgba(220,38,38,0.2);">\n        <div style="font-size: 32px; margin-bottom: 8px;">â¤ï¸</div>\n        <div style="font-size: 24px; font-weight: 700; color: var(--text);">${t}</div>\n        <div style="color: var(--muted); font-size: 14px;">Me Gusta Totales</div>\n      </div>\n      \n      <div style="text-align: center; padding: 16px; background: rgba(16,163,74,0.1); border-radius: var(--radius-sm); border: 1px solid rgba(16,163,74,0.2);">\n        <div style="font-size: 32px; margin-bottom: 8px;">ğŸ’¬</div>\n        <div style="font-size: 24px; font-weight: 700; color: var(--text);">${a}</div>\n        <div style="color: var(--muted); font-size: 14px;">Comentarios Totales</div>\n      </div>\n      \n      ${"admin"===e.role?'\n        <div style="text-align: center; padding: 16px; background: rgba(147,51,234,0.1); border-radius: var(--radius-sm); border: 1px solid rgba(147,51,234,0.2);">\n          <div style="font-size: 32px; margin-bottom: 8px;">âš™ï¸</div>\n          <div style="font-size: 24px; font-weight: 700; color: var(--text);">Admin</div>\n          <div style="color: var(--muted); font-size: 14px;">Permisos Completos</div>\n        </div>\n      ':""}\n    </div>\n  `}(t)}\n        </div>\n\n        \x3c!-- Admin Panel --\x3e\n        ${o?'\n          <div style="background: linear-gradient(135deg, rgba(37,99,235,0.1), rgba(29,78,216,0.05)); border-radius: var(--radius); padding: 24px; border: 2px solid var(--accent); box-shadow: var(--shadow);">\n            <h3 style="margin-top: 0; color: var(--text); display: flex; align-items: center; gap: 8px;">\n              <span>âš™ï¸</span> Panel de AdministraciÃ³n\n            </h3>\n            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">\n              <button onclick="openPublishModal()" class="admin-action-btn">\n                <span style="font-size: 24px;">âœï¸</span>\n                <div>\n                  <strong>Nueva PublicaciÃ³n</strong>\n                  <div>Crear contenido</div>\n                </div>\n              </button>\n              <button onclick="openBannerEditor()" class="admin-action-btn">\n                <span style="font-size: 24px;">ğŸ–¼ï¸</span>\n                <div>\n                  \n                  <div>Gestionar carrusel</div>\n                </div>\n              </button>\n              <button onclick="openSocialEditor()" class="admin-action-btn">\n                <span style="font-size: 24px;">ğŸŒ</span>\n                <div>\n                  <strong>Redes Sociales</strong>\n                  <div>Configurar enlaces</div>\n                </div>\n              </button>\n              <button onclick="showUserManagement()" class="admin-action-btn">\n                <span style="font-size: 24px;">ğŸ‘¥</span>\n                <div>\n                  <strong>GestiÃ³n</strong>\n                  <div>Ver estadÃ­sticas</div>\n                </div>\n              </button>\n            </div>\n          </div>\n        ':""}\n\n        \x3c!-- Account Settings --\x3e\n        <div style="background: linear-gradient(135deg, var(--card), var(--panel)); border-radius: var(--radius); padding: 24px; border: 1px solid var(--border); box-shadow: var(--shadow);">\n          <h3 style="margin-top: 0; color: var(--text); display: flex; align-items: center; gap: 8px;">\n            <span>âš™ï¸</span> ConfiguraciÃ³n de Cuenta\n          </h3>\n          <div style="display: grid; gap: 16px;">\n            <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm);">\n              <div>\n                <strong style="color: var(--text);">Nombre de Usuario</strong>\n                <div style="color: var(--muted); font-size: 14px;">Tu identificador Ãºnico en el sistema</div>\n              </div>\n              <div style="color: var(--accent-light); font-weight: 600;">\n                ${s(t.username)}\n              </div>\n            </div>\n            \n            <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm);">\n              <div>\n                <strong style="color: var(--text);">Tipo de Cuenta</strong>\n                <div style="color: var(--muted); font-size: 14px;">Nivel de acceso y permisos</div>\n              </div>\n              <div style="background: ${o?"var(--accent)":"var(--success)"}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">\n                ${o?"ğŸ‘¨â€ğŸ’¼ Administrador":"ğŸ“ Usuario"}\n              </div>\n            </div>\n            \n            <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm);">\n              <div>\n                <strong style="color: var(--text);">Estado de SesiÃ³n</strong>\n                <div style="color: var(--muted); font-size: 14px;">SesiÃ³n actual activa</div>\n              </div>\n              <div style="background: var(--success); color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">\n                ğŸŸ¢ Conectado\n              </div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Logout Section --\x3e\n        <div style="text-align: center; padding: 24px; background: rgba(220,38,38,0.1); border-radius: var(--radius); border: 1px solid rgba(220,38,38,0.2);">\n          <h4 style="margin-top: 0; color: var(--text);">ğŸšª Cerrar SesiÃ³n</h4>\n          <p style="color: var(--muted); margin-bottom: 20px;">\n            Â¿Deseas cerrar tu sesiÃ³n actual? PerderÃ¡s el acceso a las funciones exclusivas.\n          </p>\n          <button id="profile-logout-btn" class="btn-cancelar" style="font-size: 16px;">\n            ğŸšª Cerrar SesiÃ³n\n          </button>\n        </div>\n      </div>\n    </div>\n  `;if(!document.querySelector("#admin-profile-styles")){const e=document.createElement("div");e.id="admin-profile-styles",e.innerHTML="\n    <style>\n      .admin-action-btn {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n        padding: 16px;\n        background: rgba(255,255,255,0.05);\n        border: 1px solid var(--border);\n        border-radius: var(--radius-sm);\n        cursor: pointer;\n        transition: all var(--fast);\n        color: var(--text);\n        text-align: left;\n      }\n      \n      .admin-action-btn:hover {\n        background: rgba(37,99,235,0.1);\n        border-color: var(--accent);\n        transform: translateY(-2px);\n      }\n      \n      .admin-action-btn strong {\n        display: block;\n        margin-bottom: 4px;\n      }\n      \n      .admin-action-btn div div {\n        font-size: 14px;\n        color: var(--muted);\n      }\n    </style>\n  ",document.head.appendChild(e)}n.querySelector("#profile-logout-btn").onclick=()=>{confirm("Â¿EstÃ¡ seguro de que desea cerrar sesiÃ³n?")&&(localStorage.removeItem("user"),d("ğŸ‘‹ SesiÃ³n cerrada correctamente","success"),setTimeout(()=>location.reload(),1e3))}}function s(e){const n=document.createElement("div");return n.textContent=e||"",n.innerHTML}function d(e,n="success"){const t=document.createElement("div");t.className="toast-message",t.textContent=e,"error"===n&&(t.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(t),setTimeout(()=>{t.parentNode&&(t.style.animation="slideInRight 0.3s ease-out reverse",setTimeout(()=>t.remove(),300))},3e3)}function l(){const n=document.getElementById("fabStack");n&&n.remove();const t=JSON.parse(localStorage.getItem("user")||"{}"),a=document.createElement("div");a.id="fabStack",a.className="fab-stack",document.body.appendChild(a);const o=document.createElement("button");o.className="fab primary",o.id="socialFab",o.title="Redes Sociales",o.innerHTML="ğŸŒ",a.appendChild(o);const r=document.createElement("div");if(r.id="socialDropdown",r.className="social-dropdown",document.body.appendChild(r),o.addEventListener("click",e=>{e.stopPropagation(),document.querySelectorAll(".user-dropdown.show, .menu-options.show").forEach(e=>{e.classList.remove("show")}),r.classList.toggle("show")}),"admin"===t.role){const n=document.createElement("button");n.className="fab secondary",n.id="publishFab",n.title="Nueva PublicaciÃ³n",n.innerHTML="âœï¸",a.appendChild(n),n.addEventListener("click",()=>{e(()=>import("./Publish-BG02N97L.js"),[]).then(e=>{e.renderPublish(document.body,e=>{y("ğŸš€ PublicaciÃ³n creada exitosamente","success"),setTimeout(()=>{const e=function(){const e=document.querySelector(".nav-btn.active");return e?e.getAttribute("data-page"):"home"}();["home","news","projects"].includes(e)&&location.reload()},1500)})})});const t=document.createElement("button");t.className="fab secondary",t.id="editAboutFab",t.title="Editar InformaciÃ³n Institucional",t.innerHTML="ğŸ«",a.appendChild(t),t.addEventListener("click",()=>{e(()=>import("./about-CDI6OUSm.js"),[]).then(e=>{e.openEditAboutModal()})});const o=document.createElement("button");o.className="fab secondary",o.id="editBannersFab",o.title="Editar Banners",o.innerHTML="ğŸ–¼ï¸",a.appendChild(o),o.addEventListener("click",()=>{p()});const r=document.createElement("button");r.className="fab alert",r.id="editSocialFab",r.title="Configurar Redes Sociales",r.innerHTML="âš™ï¸",a.appendChild(r),r.addEventListener("click",()=>{u()});const i=document.createElement("button");i.className="fab alert",i.id="adminPanelFab",i.title="Panel de AdministraciÃ³n",i.innerHTML="ğŸ‘¤",a.appendChild(i),i.addEventListener("click",()=>{!function(){const n=JSON.parse(localStorage.getItem("user")||"{}");if("admin"!==n.role)return void y("âŒ Solo los administradores pueden acceder al panel","error");const t=document.getElementById("adminPanelModal");t&&t.remove();const a=document.createElement("div");a.id="adminPanelModal",a.className="modal",a.innerHTML=`\n    <div class="modal-content" style="max-width: 600px;">\n      <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">\n        <h3 style="margin: 0; font-size: 24px; color: var(--text);">ğŸ‘¤ Panel de AdministraciÃ³n</h3>\n        <button id="closeAdminPanel" class="btn-cancelar" style="padding: 8px 16px;">âœ• Cerrar</button>\n      </header>\n      \n      <div style="display: grid; gap: 16px;">\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); border: 1px solid var(--border);">\n          <h4 style="margin: 0 0 12px 0; color: var(--accent-light);">ğŸ“ GestiÃ³n de Contenido</h4>\n          <div style="display: grid; gap: 8px;">\n            <button class="btn-publicar admin-action-btn" data-action="publish">âœï¸ Nueva PublicaciÃ³n</button>\n            \n            <button class="btn-publicar admin-action-btn" data-action="about">ğŸ« Editar InformaciÃ³n Institucional</button>\n            <button class="btn-publicar admin-action-btn" data-action="changepw">ğŸ”‘ Cambiar contraseÃ±a (admin)</button>\n          </div>\n        </div>\n\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); border: 1px solid var(--border);">\n          <h4 style="margin: 0 0 12px 0; color: var(--accent-light);">âš™ï¸ ConfiguraciÃ³n</h4>\n          <div style="display: grid; gap: 8px;">\n            <button class="btn-publicar admin-action-btn" data-action="social">ğŸŒ Configurar Redes Sociales</button>\n            <button class="btn-publicar admin-action-btn" data-action="logo">ğŸ“· Cambiar Logo</button>\n            <button class="btn-publicar admin-action-btn" data-action="stats">ğŸ“Š Ver EstadÃ­sticas</button>\n          </div>\n        </div>\n\n        <div style="background: rgba(220,38,38,0.1); padding: 16px; border-radius: var(--radius); border: 1px solid rgba(220,38,38,0.3);">\n          <h4 style="margin: 0 0 12px 0; color: var(--danger);">ğŸ—‚ï¸ GestiÃ³n de Datos</h4>\n          <div style="display: grid; gap: 8px;">\n            <button class="btn-cancelar admin-action-btn" data-action="export">ğŸ“¤ Exportar Datos</button>\n            <button class="btn-cancelar admin-action-btn" data-action="backup">ğŸ’¾ Crear Respaldo</button>\n            <button class="btn-cancelar admin-action-btn" data-action="reset">ğŸ”„ Restablecer Contenido</button>\n          </div>\n        </div>\n      </div>\n\n      <div style="margin-top: 24px; padding-top: 16px; border-top: 2px solid var(--border); text-align: center; color: var(--muted);">\n        <p style="margin: 0; font-size: 14px;">Conectado como: <strong>${b(n.username||"Admin")}</strong></p>\n        <p style="margin: 4px 0 0 0; font-size: 12px;">Panel de AdministraciÃ³n - IE Valdivia</p>\n      </div>\n    </div>\n  `,document.body.appendChild(a),a.querySelector("#closeAdminPanel").onclick=()=>a.remove(),a.addEventListener("click",e=>{e.target===a&&a.remove()}),a.querySelectorAll(".admin-action-btn").forEach(n=>{n.addEventListener("click",()=>{var t;const o=n.dataset.action;switch(a.remove(),o){case"publish":e(()=>import("./Publish-BG02N97L.js"),[]).then(e=>{e.renderPublish(document.body,()=>{y("âœ… PublicaciÃ³n creada","success"),setTimeout(()=>location.reload(),1e3)})});break;case"banners":p();break;case"about":e(()=>import("./about-CDI6OUSm.js"),[]).then(e=>{e.openEditAboutModal()});break;case"social":u();break;case"logo":null==(t=document.getElementById("logo-upload"))||t.click();break;case"stats":!function(){const e=JSON.parse(localStorage.getItem("posts")||"[]"),n=JSON.parse(localStorage.getItem("socialLinks")||"[]"),t=document.createElement("div");t.className="modal",t.innerHTML=`\n    <div class="modal-content" style="max-width: 500px;">\n      <h3>ğŸ“Š EstadÃ­sticas del Sitio</h3>\n      <div style="display: grid; gap: 16px;">\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); text-align: center;">\n          <div style="font-size: 32px; font-weight: 700; color: var(--accent);">${e.length}</div>\n          <div>Publicaciones totales</div>\n        </div>\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); text-align: center;">\n          <div style="font-size: 32px; font-weight: 700; color: var(--accent);">${e.filter(e=>"noticias"===e.category).length}</div>\n          <div>Noticias</div>\n        </div>\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); text-align: center;">\n          <div style="font-size: 32px; font-weight: 700; color: var(--accent);">${e.filter(e=>"proyectos"===e.category).length}</div>\n          <div>Proyectos</div>\n        </div>\n        <div style="background: rgba(37,99,235,0.1); padding: 16px; border-radius: var(--radius); text-align: center;">\n          <div style="font-size: 32px; font-weight: 700; color: var(--accent);">${n.length}</div>\n          <div>Redes sociales configuradas</div>\n        </div>\n      </div>\n      <div style="text-align: center; margin-top: 20px;">\n        <button class="btn-cancelar" onclick="this.closest('.modal').remove()">Cerrar</button>\n      </div>\n    </div>\n  `,t.addEventListener("click",e=>{e.target===t&&t.remove()}),document.body.appendChild(t)}();break;case"export":!function(){const e={posts:JSON.parse(localStorage.getItem("posts")||"[]"),aboutContent:JSON.parse(localStorage.getItem("aboutContent")||"{}"),socialLinks:JSON.parse(localStorage.getItem("socialLinks")||"[]"),schoolLogo:localStorage.getItem("schoolLogo"),exportDate:(new Date).toISOString()},n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(n),a=document.createElement("a");a.href=t,a.download=`ie-valdivia-backup-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(t),y("ğŸ“¤ Datos exportados exitosamente","success")}();break;case"backup":!function(){const e=`backup_${Date.now()}`,n={posts:localStorage.getItem("posts"),aboutContent:localStorage.getItem("aboutContent"),socialLinks:localStorage.getItem("socialLinks"),schoolLogo:localStorage.getItem("schoolLogo"),date:(new Date).toISOString()};localStorage.setItem(e,JSON.stringify(n)),y("ğŸ’¾ Respaldo creado exitosamente","success")}();break;case"reset":!function(){if(!confirm("âš ï¸ Â¿EstÃ¡s seguro de que quieres restablecer todo el contenido? Esta acciÃ³n no se puede deshacer."))return;if(!confirm("ğŸš¨ ÃšLTIMA ADVERTENCIA: Se perderÃ¡ TODO el contenido actual. Â¿Continuar?"))return;localStorage.removeItem("posts"),localStorage.removeItem("aboutContent"),localStorage.removeItem("socialLinks"),y("ğŸ”„ Contenido restablecido","success"),setTimeout(()=>location.reload(),1500)}()}})})}()})}c()}function c(){const e=document.getElementById("socialDropdown");if(!e)return;const n=JSON.parse(localStorage.getItem("socialLinks")||"[]");n.length?(e.innerHTML=`\n    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 2px solid var(--border);">\n      <div style="font-weight: 700; color: var(--text); font-size: 16px; text-align: center;">ğŸŒ SÃ­guenos en:</div>\n    </div>\n    ${n.map(e=>`\n      <a href="${b(e.url)}" \n         target="_blank" \n         rel="noopener noreferrer"\n         title="Visitar ${b(e.name)}"\n         style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius-sm); transition: all var(--fast); text-decoration: none; color: var(--text); font-weight: 600;">\n        <span style="font-size: 20px;">${v(e.name)}</span>\n        <span>${b(e.name)}</span>\n        <span style="margin-left: auto; font-size: 12px; color: var(--muted);">â†—ï¸</span>\n      </a>\n    `).join("")}\n    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); text-align: center;">\n      <div style="font-size: 12px; color: var(--muted);">IE Valdivia Â© ${(new Date).getFullYear()}</div>\n    </div>\n  `,e.querySelectorAll("a").forEach(e=>{e.addEventListener("mouseenter",()=>{e.style.background="rgba(37,99,235,0.1)",e.style.transform="translateX(8px)"}),e.addEventListener("mouseleave",()=>{e.style.background="transparent",e.style.transform="translateX(0)"})})):e.innerHTML='\n      <div style="padding: 20px; text-align: center; color: var(--muted);">\n        <div style="font-size: 32px; margin-bottom: 12px;">ğŸŒ</div>\n        <h4 style="margin: 0 0 8px 0; color: var(--text);">Redes Sociales</h4>\n        <p style="margin: 0; font-size: 14px;">No hay redes configuradas</p>\n        <p style="margin: 8px 0 0 0; font-size: 12px; color: var(--muted);">Los administradores pueden agregar enlaces</p>\n      </div>\n    '}function p(){e(()=>Promise.resolve().then(()=>z),void 0).then(e=>{e&&"function"==typeof e.openBannerModal?e.openBannerModal():y("ğŸ–¼ï¸ Editor de banners no disponible","error")}).catch(e=>{y("ğŸ–¼ï¸ Error al abrir el editor de banners","error")})}function u(){if("admin"!==JSON.parse(localStorage.getItem("user")||"{}").role)return void y("âŒ Solo los administradores pueden editar las redes sociales","error");const e=document.getElementById("editSocialsModal");e&&e.remove();const n=document.createElement("div");n.id="editSocialsModal",n.className="modal",n.innerHTML='\n    <div class="modal-content">\n      <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">\n        <h3 style="margin: 0; font-size: 24px; color: var(--text);">âš™ï¸ Configurar Redes Sociales</h3>\n        <button id="closeSocialsModal" class="btn-cancelar" style="padding: 8px 16px;">âœ• Cerrar</button>\n      </header>\n      \n      <div id="socialsList" style="margin-bottom: 24px;"></div>\n      \n      <div style="background: rgba(37,99,235,0.1); padding: 20px; border-radius: var(--radius); border: 1px solid var(--border);">\n        <h4 style="margin-top: 0; color: var(--text);">â• Agregar Nueva Red Social</h4>\n        <div style="display: grid; gap: 16px;">\n          <div>\n            <label for="newSocialName">ğŸ·ï¸ Nombre de la red social</label>\n            <input type="text" id="newSocialName" placeholder="Facebook, YouTube, Instagram, WhatsApp..." />\n          </div>\n          <div>\n            <label for="newSocialUrl">ğŸ”— URL completa</label>\n            <input type="url" id="newSocialUrl" placeholder="https://facebook.com/tu-pagina" />\n          </div>\n          <div style="text-align: right;">\n            <button id="addSocialBtn" class="btn-publicar">â• Agregar Red</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',document.body.appendChild(n),n.querySelector("#closeSocialsModal").onclick=()=>n.remove(),n.addEventListener("click",e=>{e.target===n&&n.remove()}),m(),n.querySelector("#addSocialBtn").addEventListener("click",g)}function m(){const e=document.getElementById("socialsList");if(!e)return;const n=JSON.parse(localStorage.getItem("socialLinks")||"[]");n.length?(e.innerHTML=`\n    <h4 style="margin-bottom: 16px; color: var(--text);">ğŸ“‹ Redes Sociales Actuales (${n.length})</h4>\n    ${n.map((e,n)=>`\n      <div class="social-edit-item" style="display: flex; gap: 16px; align-items: center; padding: 16px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm); margin-bottom: 12px; border: 1px solid var(--border);">\n        <div style="font-size: 24px; flex-shrink: 0;">\n          ${v(e.name)}\n        </div>\n        <div style="flex: 1; display: grid; gap: 8px;">\n          <input type="text" value="${b(e.name)}" \n                 placeholder="Nombre de la red..." \n                 data-index="${n}" \n                 class="social-name-input"\n                 style="background: rgba(255,255,255,0.05);" />\n          <input type="url" value="${b(e.url)}" \n                 placeholder="https://..." \n                 data-index="${n}" \n                 class="social-url-input"\n                 style="background: rgba(255,255,255,0.05);" />\n        </div>\n        <div>\n          <button class="btn-cancelar" onclick="removeSocial(${n})" style="font-size: 14px; padding: 8px 16px;">\n            ğŸ—‘ï¸ Eliminar\n          </button>\n        </div>\n      </div>\n    `).join("")}\n  `,e.querySelectorAll(".social-name-input").forEach(e=>{e.addEventListener("change",e=>{const n=parseInt(e.target.dataset.index),t=JSON.parse(localStorage.getItem("socialLinks")||"[]");t[n]&&(t[n].name=e.target.value.trim(),localStorage.setItem("socialLinks",JSON.stringify(t)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({socialLinks:t})}),c(),m())})}),e.querySelectorAll(".social-url-input").forEach(e=>{e.addEventListener("change",e=>{const n=parseInt(e.target.dataset.index),t=JSON.parse(localStorage.getItem("socialLinks")||"[]");t[n]&&(t[n].url=e.target.value.trim(),localStorage.setItem("socialLinks",JSON.stringify(t)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({socialLinks:t})}),c())})})):e.innerHTML='\n      <div style="text-align: center; padding: 40px; color: var(--muted); border: 2px dashed var(--border); border-radius: var(--radius);">\n        <div style="font-size: 48px; margin-bottom: 16px;">ğŸŒ</div>\n        <h4>No hay redes sociales configuradas</h4>\n        <p>Agrega la primera red social usando el formulario de abajo</p>\n      </div>\n    '}function g(){const e=document.getElementById("newSocialName"),n=document.getElementById("newSocialUrl"),t=e.value.trim(),a=n.value.trim();if(!t||!a)return void y("âŒ Completa ambos campos","error");try{new URL(a)}catch{return void y("âŒ URL invÃ¡lida. Debe comenzar con http:// o https://","error")}const o=JSON.parse(localStorage.getItem("socialLinks")||"[]");o.some(e=>e.name.toLowerCase()===t.toLowerCase())?y("âŒ Ya existe una red social con ese nombre","error"):(o.push({name:t,url:a}),localStorage.setItem("socialLinks",JSON.stringify(o)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({socialLinks:o})}),e.value="",n.value="",m(),c(),y("âœ… Red social agregada exitosamente","success"))}function v(e){const n=e.toLowerCase();return n.includes("facebook")?"ğŸ“˜":n.includes("instagram")?"ğŸ“·":n.includes("youtube")?"ğŸ“º":n.includes("twitter")||n.includes("x.com")?"ğŸ¦":n.includes("linkedin")?"ğŸ’¼":n.includes("tiktok")?"ğŸµ":n.includes("whatsapp")?"ğŸ’¬":n.includes("telegram")?"âœˆï¸":n.includes("discord")?"ğŸ®":n.includes("github")?"ğŸ’»":n.includes("email")||n.includes("correo")?"ğŸ“§":n.includes("web")||n.includes("sitio")?"ğŸŒ":"ğŸ”—"}function b(e){const n=document.createElement("div");return n.textContent=e||"",n.innerHTML}function y(e,n="success"){const t=document.createElement("div");t.className="toast-message",t.textContent=e,"error"===n&&(t.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(t),setTimeout(()=>{t.parentNode&&(t.style.animation="slideInRight 0.3s ease-out reverse",setTimeout(()=>t.remove(),300))},3e3)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)}).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const n=function(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?n.credentials="include":"anonymous"===e.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(e);fetch(e.href,n)}}(),window.openPublishModal=function(){e(()=>import("./Publish-BG02N97L.js"),[]).then(e=>{e.renderPublish(document.body,e=>{d("ğŸš€ PublicaciÃ³n creada exitosamente","success")})})},window.openBannerEditor=function(){e(()=>Promise.resolve().then(()=>z),void 0).then(e=>{e.openBannerModal()})},window.openSocialEditor=function(){e(()=>Promise.resolve().then(()=>h),void 0).then(e=>{const n=new CustomEvent("openSocialEditor");document.dispatchEvent(n)}),setTimeout(()=>{const n=document.getElementById("editSocialFab");n?n.click():(d("ğŸŒ Abriendo editor de redes sociales...","success"),e(()=>Promise.resolve().then(()=>h),void 0).then(()=>{window.openEditSocials&&window.openEditSocials()}))},100)},window.showUserManagement=function(){d("ğŸ“Š FunciÃ³n de gestiÃ³n en desarrollo","success")},window.removeSocial=function(e){if(!confirm("Â¿EstÃ¡s seguro de que quieres eliminar esta red social?"))return;const n=JSON.parse(localStorage.getItem("socialLinks")||"[]");n.splice(e,1),localStorage.setItem("socialLinks",JSON.stringify(n)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({socialLinks:n})}),m(),c(),y("ğŸ—‘ï¸ Red social eliminada","success")},document.addEventListener("click",function(n){const t=n.target.closest&&n.target.closest(".admin-action-btn");if(!t)return;const a=t.dataset.action;"publish"===a?e(()=>import("./Publish-BG02N97L.js"),[]).then(e=>{e.openPublishModal&&e.openPublishModal()}):"about"===a?e(()=>import("./about-CDI6OUSm.js"),[]).then(e=>{e.openEditAboutModal&&e.openEditAboutModal()}):"social"===a||"changepw"===a&&e(()=>import("./ChangePassword-CBJwj7Y0.js"),[]).then(e=>{e.openChangePasswordModal&&e.openChangePasswordModal()})});const h=Object.freeze(Object.defineProperty({__proto__:null,renderFloatingMenu:l},Symbol.toStringTag,{value:"Module"}));let x=JSON.parse(localStorage.getItem("banners"))||[],f=0,S=null;function w(){return"admin"===JSON.parse(localStorage.getItem("user")||"{}").role}function E(){document.getElementById("bannerSection")&&(x=JSON.parse(localStorage.getItem("banners"))||[],w(),k())}function k(){const e=document.getElementById("bannerSection");e&&(x=JSON.parse(localStorage.getItem("banners"))||[],x.length?(e.innerHTML=`\n    <div class="banners-frame" role="region" aria-label="Carrusel de banners">\n      <div class="banners-track" id="bannersTrack" style="display:flex;transform:translateX(-${100*f}%);transition:transform 420ms cubic-bezier(.22,.9,.35,1);">\n        ${x.map((e,n)=>`\n          <div class="banner-slide" style="min-width:100%;height:260px;position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;">\n            ${function(e){const n=e.url||"",t=/youtube\.com|youtu\.be/i.test(n),a=/\.(mp4|webm|ogg)(\?.*)?$/i.test(n);if(t){let e=n.replace(/watch\?v=/,"embed/").replace(/youtu\.be\//,"youtube.com/embed/");if(!/embed\//i.test(e)){const t=n.match(/(?:v=|youtu\.be\/)([A-Za-z0-9_-]{6,})/);t&&t[1]&&(e=`https://www.youtube.com/embed/${t[1]}`)}return`<iframe src="${e}" width="100%" height="260" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="border:0;"></iframe>`}if(a)return`<video src="${O(n)}" style="width:100%;height:100%;object-fit:cover;" autoplay muted loop playsinline></video>`;return`<img src="${O(n)}" alt="${O(e.title||"Banner")}" style="width:100%;height:100%;object-fit:cover;display:block;" />`}(e)}\n            <div class="banner-overlay-led" aria-hidden="true"></div>\n            ${e.title?`<div class="banner-title-overlay"><h3>${O(e.title)}</h3></div>`:""}\n          </div>\n        `).join("")}\n      </div>\n\n      <div class="banner-nav" aria-hidden="true">\n        <button id="bannerPrev" class="banner-arrow" aria-label="Banner anterior">â®</button>\n        <button id="bannerNext" class="banner-arrow" aria-label="Siguiente banner">â¯</button>\n      </div>\n\n      <div class="banner-dots" id="bannerDots" aria-hidden="true">\n        ${x.map((e,n)=>`<button class="banner-dot ${n===f?"active":""}" data-index="${n}"></button>`).join("")}\n      </div>\n    </div>\n  `,function(){const e=document.getElementById("bannersTrack"),n=document.getElementById("bannerPrev"),t=document.getElementById("bannerNext"),a=document.getElementById("bannerDots");if(!e)return;null==n||n.addEventListener("click",()=>{f=(f-1+x.length)%x.length,L(),_()}),null==t||t.addEventListener("click",()=>{f=(f+1)%x.length,L(),_()}),null==a||a.querySelectorAll(".banner-dot").forEach(e=>{e.addEventListener("click",e=>{const n=Number(e.currentTarget.dataset.index);f=n,L(),_()})});let o=0;const r=document.querySelector(".banners-frame");null==r||r.addEventListener("touchstart",e=>o=e.touches[0].clientX),null==r||r.addEventListener("touchend",e=>{const n=e.changedTouches[0].clientX,t=o-n;Math.abs(t)>50&&(f=t>0?(f+1)%x.length:(f-1+x.length)%x.length,L(),_())}),null==r||r.addEventListener("mouseenter",T),null==r||r.addEventListener("mouseleave",I)}(),I()):e.innerHTML='\n      <div class="banners-frame" style="padding: 60px 20px; text-align: center; color: var(--muted);">\n        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ–¼ï¸</div>\n        <h3>No hay banners configurados</h3>\n        <p>Los administradores pueden agregar banners desde el botÃ³n de ediciÃ³n</p>\n      </div>\n    ')}function L(){const e=document.getElementById("bannersTrack");if(!e)return;e.style.transform=`translateX(-${100*f}%)`;document.querySelectorAll(".banner-dot").forEach((e,n)=>e.classList.toggle("active",n===f))}function I(){x.length<=1||(clearInterval(S),S=setInterval(()=>{f=(f+1)%x.length,L()},6e3))}function T(){clearInterval(S)}function _(){clearInterval(S),I()}function N(){const e=document.getElementById("bannerList");e&&(x=JSON.parse(localStorage.getItem("banners"))||[],x.length?(e.innerHTML=x.map((e,n)=>`\n    <div style="display:flex;gap:12px;align-items:center;padding:10px;background:rgba(255,255,255,0.02);border-radius:10px;margin-bottom:8px;border:1px solid rgba(255,255,255,0.03)">\n      <div style="width:140px;flex-shrink:0;">\n        ${function(e=""){return!!e&&(!!/youtube\.com|youtu\.be/i.test(e)||/\.(mp4|webm|ogg)(\?.*)?$/i.test(e))}(e.url)?`<div style="width:140px;height:80px;background:#000;border-radius:8px;overflow:hidden"><video src="${O(e.url)}" style="width:100%;height:100%;object-fit:cover" muted loop></video></div>`:`<img src="${O(e.url)}" style="width:140px;height:80px;object-fit:cover;border-radius:8px;" alt="thumb" />`}\n      </div>\n      <div style="flex:1;display:grid;gap:8px;">\n        <input data-i="${n}" class="bn-title" value="${O(e.title||"")}" placeholder="TÃ­tulo" style="padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03)" />\n        <input data-i="${n}" class="bn-href" value="${O(e.href||"")}" placeholder="Enlace (opcional)" style="padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03)" />\n      </div>\n      <div style="display:flex;flex-direction:column;gap:8px;">\n        <input type="file" data-i="${n}" class="bn-file" accept="image/*,video/*" />\n        <button class="btn-cancelar bn-del" data-i="${n}">Eliminar</button>\n      </div>\n    </div>\n  `).join(""),e.querySelectorAll(".bn-del").forEach(e=>{e.addEventListener("click",e=>{const n=Number(e.currentTarget.dataset.i);confirm("Eliminar banner?")&&(x.splice(n,1),C(),N(),k(),f>=x.length&&(f=0),A("ğŸ—‘ï¸ Banner eliminado","success"))})}),e.querySelectorAll(".bn-title").forEach(e=>{e.addEventListener("change",e=>{const n=Number(e.target.dataset.i);x[n].title=e.target.value,C(),k()})}),e.querySelectorAll(".bn-href").forEach(e=>{e.addEventListener("change",e=>{const n=Number(e.target.dataset.i);x[n].href=e.target.value,C()})}),e.querySelectorAll(".bn-file").forEach(e=>{e.addEventListener("change",async e=>{const n=e.target.files[0];if(n)if(n.size>2097152)A("âŒ Archivo muy grande. MÃ¡ximo 2MB","error");else try{const t=await P(n),a=Number(e.target.dataset.i);x[a].url=t,C(),N(),k(),A("âœ… Imagen del banner actualizada","success")}catch{A("âŒ Error al leer archivo","error")}})})):e.innerHTML='<div style="padding:18px;text-align:center;color:var(--muted);border-radius:8px;border:1px dashed rgba(255,255,255,0.03)">No hay banners guardados</div>')}function C(){localStorage.setItem("banners",JSON.stringify(x)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({banners:x})})}function P(e){return new Promise((n,t)=>{const a=new FileReader;a.onload=()=>n(String(a.result)),a.onerror=()=>t(new Error("Error reading file")),a.readAsDataURL(e)})}function O(e=""){const n=document.createElement("div");return n.textContent=e||"",n.innerHTML}function A(e,n="success"){const t=document.createElement("div");t.className="toast-message",t.textContent=e,"error"===n&&(t.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(t),setTimeout(()=>{t.parentNode&&(t.style.animation="slideInRight 0.3s ease-out reverse",setTimeout(()=>t.remove(),300))},3e3)}window.addEventListener("app:postsUpdated",function(){try{k()}catch(e){}}),window.addEventListener("storage",function(e){if("posts"===e.key||"posts_update_ts"===e.key)try{k()}catch(n){}});const z=Object.freeze(Object.defineProperty({__proto__:null,openBannerModal:function(){if(!w())return void A("âŒ Solo los administradores pueden editar banners","error");const e=document.getElementById("bannerEditorModal");e&&e.remove();const n=document.createElement("div");n.id="bannerEditorModal",n.className="modal",n.innerHTML='\n    <div class="modal-content" style="max-width:820px;">\n      <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">\n        <h3 style="margin:0">Editor de Banners</h3>\n        <button id="closeBannerModal" class="btn-cancelar">Cerrar</button>\n      </header>\n\n      <div id="bannerList" style="margin-bottom:18px;"></div>\n\n      <div style="display:grid;gap:12px;background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;">\n        <label style="font-weight:600">Agregar nuevo banner (archivo o URL)</label>\n\n        <div style="display:flex;gap:12px;align-items:center;">\n          <div style="flex:1">\n            <input type="file" id="newBannerFile" accept="image/*,video/*" />\n            <div style="font-size:12px;color:var(--muted);margin-top:6px">O pega una URL en el campo de abajo (YouTube, mp4, imagen)</div>\n          </div>\n\n          <div style="width:220px;">\n            <input type="text" id="newBannerUrl" placeholder="https://..." style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)" />\n          </div>\n        </div>\n\n        <div style="display:flex;gap:8px;">\n          <input type="text" id="newBannerTitle" placeholder="TÃ­tulo (opcional)" style="flex:1;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)" />\n          <input type="url" id="newBannerLink" placeholder="Enlace (opcional) https://..." style="width:260px;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)" />\n        </div>\n\n        <div style="text-align:right">\n          <button id="addBannerBtn" class="btn-publicar">â• Agregar Banner</button>\n        </div>\n      </div>\n    </div>\n  ',document.body.appendChild(n),n.querySelector("#closeBannerModal").onclick=()=>n.remove(),n.addEventListener("click",e=>{e.target===n&&n.remove()}),N(),n.querySelector("#addBannerBtn").addEventListener("click",async()=>{const e=n.querySelector("#newBannerFile"),t=n.querySelector("#newBannerUrl"),a=n.querySelector("#newBannerTitle"),o=n.querySelector("#newBannerLink"),r=e.files[0],i=t.value.trim(),s=a.value.trim(),d=o.value.trim();if(r||i)if(x.length>=5)A("âŒ MÃ¡ximo 5 banners permitidos","error");else try{let n="";if(r){if(r.size>2097152)return void A("âŒ Archivo muy grande. MÃ¡ximo 2MB","error");n=await P(r)}else n=i;x.push({url:n,title:s||"",href:d||""}),C(),N(),k(),e.value="",t.value="",a.value="",o.value="",A("âœ… Banner agregado exitosamente","success")}catch(l){A("âŒ Error agregando banner","error")}else A("âŒ Selecciona un archivo o pega una URL.","error")})},setupBannerSection:E},Symbol.toStringTag,{value:"Module"})),M=document.getElementById("root");function $(e,n="success"){const t=document.createElement("div");t.className="toast-message",t.textContent=e,"error"===n&&(t.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(t),setTimeout(()=>{t.parentNode&&(t.style.opacity="0",t.style.transition="opacity 0.28s",setTimeout(()=>t.remove(),300))},3e3)}document.addEventListener("keydown",e=>{"Escape"===e.key&&(document.querySelectorAll(".modal").forEach(e=>e.remove()),document.querySelectorAll(".user-dropdown.show, .social-dropdown.show, .menu-options.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll("#searchPreview.show").forEach(e=>{e.classList.remove("show")}))}),document.addEventListener("click",e=>{e.target.closest(".user-menu")||document.querySelectorAll(".user-dropdown.show").forEach(e=>{e.classList.remove("show")}),e.target.closest("#floatingSocialBtn")||e.target.closest(".social-dropdown")||document.querySelectorAll(".social-dropdown.show").forEach(e=>{e.classList.remove("show")}),e.target.closest(".post-menu")||document.querySelectorAll(".menu-options.show").forEach(e=>{e.classList.remove("show")}),e.target.closest("#globalSearchBar")||document.querySelectorAll("#searchPreview.show").forEach(e=>{e.classList.remove("show")})}),async function(){try{const e=await fetch(`api.php?v=${Date.now()}`,{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(e.ok){const n=await e.json();n.posts&&localStorage.setItem("posts",JSON.stringify(n.posts)),n.banners&&localStorage.setItem("banners",JSON.stringify(n.banners)),n.aboutContent&&localStorage.setItem("aboutContent",JSON.stringify(n.aboutContent)),n.socialLinks&&localStorage.setItem("socialLinks",JSON.stringify(n.socialLinks)),n.schoolLogo&&localStorage.setItem("schoolLogo",n.schoolLogo)}}catch(d){}let s=JSON.parse(localStorage.getItem("posts")||"[]");t(M,t=>{const c=document.getElementById("main-content");if(c){switch(c.innerHTML="",document.querySelectorAll(".user-dropdown.show, .social-dropdown.show, .menu-options.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll("#searchPreview.show").forEach(e=>{e.classList.remove("show")}),t){case"home":default:n(c);break;case"news":a(c,s);break;case"projects":o(c,s);break;case"about":r(c);break;case"profile":i(c,JSON.parse(localStorage.getItem("user")||"{}"));break;case"publish":e(()=>import("./Publish-BG02N97L.js"),[]).then(e=>{e.renderPublish(document.body,async e=>{const t=[e,...s];await async function(e,n){try{const t=new FormData;t.append("key",e),t.append("value",JSON.stringify(n));const a=await fetch(`api.php?v=${Date.now()}`,{method:"POST",body:t,cache:"no-cache"});if(!a.ok){const e=await a.json().catch(()=>({message:"Error desconocido"}));throw new Error(e.message||`Error del servidor: ${a.status}`)}const o=await a.json();if("error"===o.status)throw new Error(o.message);return!0}catch(d){return $(`âŒ Error de sincronizaciÃ³n: ${d.message}`,"error"),!1}}("posts",t)&&(s=t,localStorage.setItem("posts",JSON.stringify(s)),localStorage.setItem("posts_update_ts",Date.now().toString()),window.dispatchEvent(new Event("app:postsUpdated")),$("âœ… PublicaciÃ³n creada exitosamente","success"));const r=function(){const e=document.querySelector(".nav-btn.active");return e?e.getAttribute("data-page"):"home"}();"news"!==r&&"projects"!==r&&"home"!==r||setTimeout(()=>{const e=document.getElementById("main-content");if(e)switch(r){case"home":n(e);break;case"news":a(e,s);break;case"projects":o(e,s)}},100)})})}document.querySelectorAll(".nav-btn").forEach(e=>{e.getAttribute("data-page")===t?e.classList.add("active"):e.classList.remove("active")}),setTimeout(()=>{try{l(document.getElementById("main-content"))}catch(d){l()}try{E()}catch(d){}},120)}})}(),e(()=>import("./Sync-CrPe6vuD.js"),__vite__mapDeps([2,1]));export{z as B};
