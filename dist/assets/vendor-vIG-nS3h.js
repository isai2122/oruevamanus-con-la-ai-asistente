function e(e,o){const n=JSON.parse(localStorage.getItem("user"))||{};e.innerHTML=`\n    <header class="main-header">\n      <div class="logo-section">\n        <img src="${localStorage.getItem("schoolLogo")||"/assets/logo-default.png"}" alt="Logo IE Valdivia" id="school-logo" />\n        <span class="site-title">IE Valdivia</span>\n        ${"admin"===n.role?'<label class="edit-logo-label" title="Editar logo">\n          Editar logo <input type="file" id="logo-upload" accept="image/*" hidden>\n        </label>':""}\n      </div>\n\n      <nav class="nav-links">\n        <button class="nav-btn active" data-page="home">Inicio</button>\n        <button class="nav-btn" data-page="news">Noticias</button>\n        <button class="nav-btn" data-page="projects">Proyectos</button>\n        <button class="nav-btn" data-page="about">Sobre Nosotros</button>\n        <button class="nav-btn" data-page="profile">Perfil</button>\n      </nav>\n\n      <div class="user-menu">\n        <div class="user-avatar" id="userAvatar" title="${n.username?`Hola, ${t(n.username)}`:"Usuario invitado"}">\n          ${n.username?t(n.username[0].toUpperCase()):"U"}\n        </div>\n        <div class="user-dropdown" id="userDropdown">\n          ${n.username?`<p><strong>${t(n.username)}</strong></p>\n             <p class="text-muted">Rol: ${t(n.role)}</p>\n             <button id="logout-btn" class="btn-cancelar">Cerrar sesión</button>`:'<p><strong>Visitante</strong></p>\n             <p class="text-muted">Acceso restringido. Si eres administrador, inicia sesión desde Perfil.</p>\n             <div style="display:flex;gap:8px;justify-content:flex-end">\n               <button id="go-profile-btn" class="btn-publicar">Ir a Perfil</button>\n             </div>'}\n        </div>\n      </div>\n    </header>\n\n    <main id="main-content" class="main-content"></main>\n  `;const a=e.querySelector("#logo-upload");a&&a.addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;if(t.size>2097152)return void i("El archivo es muy grande. Máx 2MB.","error");const o=new FileReader;o.onload=()=>{const e=o.result,t=document.getElementById("school-logo");t&&(t.src=e),localStorage.setItem("schoolLogo",e),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({schoolLogo:e})}),i("Logo actualizado","success")},o.onerror=()=>i("Error al cargar imagen","error"),o.readAsDataURL(t)});const s=e.querySelector("#userAvatar"),r=e.querySelector("#userDropdown");s&&s.addEventListener("click",e=>{e.stopPropagation(),r&&r.classList.toggle("show")});const l=e.querySelector("#go-profile-btn");l&&l.addEventListener("click",()=>{r&&r.classList.remove("show"),o("profile"),e.querySelectorAll(".nav-btn").forEach(e=>e.classList.remove("active"));const t=e.querySelector('.nav-btn[data-page="profile"]');t&&t.classList.add("active"),window.scrollTo(0,0)});const c=e.querySelector("#logout-btn");function i(e,t="success"){const o=document.createElement("div");o.className="toast-message",o.textContent=e,"error"===t&&(o.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(o),setTimeout(()=>{o.parentNode&&(o.style.opacity="0",o.style.transition="opacity .28s",setTimeout(()=>o.remove(),300))},2500)}c&&c.addEventListener("click",()=>{confirm("¿Cerrar sesión?")&&(localStorage.removeItem("user"),r&&r.classList.remove("show"),i("Sesión cerrada","success"),setTimeout(()=>location.reload(),700))}),e.querySelectorAll("button[data-page]").forEach(t=>{t.addEventListener("click",()=>{e.querySelectorAll(".nav-btn").forEach(e=>e.classList.remove("active")),t.classList.add("active"),document.querySelectorAll(".modal, .publish-overlay, #bannerEditor").forEach(e=>e.remove()),document.querySelectorAll("video, audio").forEach(e=>{try{e.pause(),e.currentTime=0}catch(t){}}),document.querySelectorAll(".user-dropdown.show, .social-dropdown.show, .menu-options.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll("#searchPreview.show").forEach(e=>e.classList.remove("show"));const n=t.getAttribute("data-page");o(n),r&&r.classList.remove("show");const a=document.getElementById("main-content");a&&(a.scrollTop=0,window.scrollTo(0,0))})}),setTimeout(()=>o("home"),0)}function t(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}export{e as r};
