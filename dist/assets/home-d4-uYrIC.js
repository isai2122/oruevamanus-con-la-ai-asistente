const e={},t=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),i=(null==t?void 0:t.nonce)||(null==t?void 0:t.getAttribute("nonce"));o=Promise.allSettled(n.map(t=>{if((t=function(e){return"/"+e}(t))in e)return;e[t]=!0;const n=t.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${o}`))return;const s=document.createElement("link");return s.rel=n?"stylesheet":"modulepreload",n||(s.as="script"),s.crossOrigin="",s.href=t,i&&s.setAttribute("nonce",i),document.head.appendChild(s),n?new Promise((e,n)=>{s.addEventListener("load",e),s.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(e=>{for(const t of e||[])"rejected"===t.status&&s(t.reason);return t().catch(s)})};function n(e){JSON.parse(localStorage.getItem("user"));const t=JSON.parse(localStorage.getItem("posts")||"[]");e.innerHTML='\n    <div id="globalSearchBar">\n      <input id="globalSearchInput" placeholder=" Buscar noticias, proyectos o contenido..." />\n      <button id="globalSearchBtn">Buscar</button>\n      <div id="searchPreview"></div>\n    </div>\n    \n    <div id="bannerSection"></div>\n    \n    <section class="featured-section">\n      <h2 style="text-align: center; margin: 40px 0 30px 0; font-size: 32px; font-weight: 800; background: linear-gradient(135deg, var(--accent-light), var(--white)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">\n        âœ¨ Contenido Destacado\n      </h2>\n      <div class="posts-grid" id="featuredGrid"></div>\n    </section>\n  ',function(e,t){const n=e.querySelector("#globalSearchInput"),a=e.querySelector("#searchPreview"),l=e.querySelector("#globalSearchBtn");let d;n.addEventListener("input",()=>{clearTimeout(d);const e=n.value.trim().toLowerCase();if(!e)return a.classList.remove("show"),void(a.innerHTML="");d=setTimeout(()=>{const i=t.filter(t=>(t.title+" "+(t.description||"")+" "+(t.category||"")).toLowerCase().includes(e)).slice(0,5);if(!i.length)return a.innerHTML='<div style="padding: 20px; text-align: center; color: var(--muted);">ğŸ“­ No se encontraron resultados</div>',void a.classList.add("show");a.innerHTML=i.map(e=>`\n        <div class="search-preview-item" data-id="${e.id}">\n          <div class="search-preview-thumb">\n            ${function(e){if(!e.image)return'<div style="display: flex; align-items: center; justify-content: center; height: 100%; background: var(--bg); color: var(--muted); font-size: 12px;">ğŸ“„</div>';if("video"===e.type&&(e.image.includes("youtube.com")||e.image.includes("youtu.be"))){const t=s(e.image);if(t)return`<img src="https://img.youtube.com/vi/${t}/mqdefault.jpg" alt="${c(e.title)}" />`}return`<img src="${e.image}" alt="${c(e.title)}" />`}(e)}\n            ${"video"===e.type?'<div class="play">â–¶ï¸</div>':""}\n          </div>\n          <div class="search-preview-info">\n            <div class="search-preview-title">${c(e.title)}</div>\n            <div class="search-preview-meta"> ${c(e.category)} â€¢ ${"video"===e.type?"ğŸ¬":"ğŸ–¼ï¸"} ${c(e.type)}</div>\n            <div style="color: var(--muted); font-size: 14px; margin-top: 8px;">\n              ${c((e.description||"").slice(0,100))}${e.description&&e.description.length>100?"...":""}\n            </div>\n          </div>\n        </div>\n      `).join(""),a.classList.add("show"),a.querySelectorAll(".search-preview-item").forEach(e=>{e.addEventListener("click",()=>{const i=Number(e.dataset.id),o=t.find(e=>e.id===i);o&&(a.classList.remove("show"),n.value="",r(o))})})},300)});const u=()=>{const s=n.value.trim().toLowerCase();if(!s)return;const r=t.filter(e=>(e.title+" "+(e.description||"")+" "+(e.category||"")).toLowerCase().includes(s)),l=e.querySelector(".featured-section");if(l){l.innerHTML=`\n        <h2 style="text-align: center; margin: 40px 0 30px 0; font-size: 32px; font-weight: 800; color: var(--text);">\n           Resultados para: "${c(s)}"\n        </h2>\n        <div class="posts-grid" id="searchResults"></div>\n        <div style="text-align: center; margin-top: 30px;">\n          <button id="clearSearch" class="btn-cancelar">ğŸ”„ Mostrar todo el contenido</button>\n        </div>\n      `;const d=l.querySelector("#searchResults");r.length?o(d,r):d.innerHTML='\n          <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--muted);">\n            <div style="font-size: 64px; margin-bottom: 20px;">ğŸ“­</div>\n            <h3>No se encontraron resultados</h3>\n            <p>Intenta con otros tÃ©rminos de bÃºsqueda</p>\n          </div>\n        ',l.querySelector("#clearSearch").addEventListener("click",()=>{n.value="",a.classList.remove("show"),i(e,t)})}a.classList.remove("show")};l.addEventListener("click",u),n.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),u())})}(e,t),i(e,t)}function i(e,t){if(!e.querySelector("#featuredGrid"))return;const n=e.querySelector(".featured-section");n.innerHTML='\n    <h2 style="text-align: center; margin: 40px 0 30px 0; font-size: 32px; font-weight: 800; background: linear-gradient(135deg, var(--accent-light), var(--white)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">\n      âœ¨ Contenido Destacado\n    </h2>\n    <div class="posts-grid" id="featuredGrid"></div>\n  ';const i=n.querySelector("#featuredGrid"),s=t.slice(0,6);s.length?o(i,s):i.innerHTML='\n      <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--muted);">\n        <div style="font-size: 64px; margin-bottom: 20px;">ğŸ“‹</div>\n        <h3>AÃºn no hay contenido</h3>\n        <p>SÃ© el primero en crear una publicaciÃ³n</p>\n      </div>\n    '}function o(e,t){const n=JSON.parse(localStorage.getItem("user"))||{};t.forEach(t=>{const i=document.createElement("div");i.className="post-card",i.innerHTML=`\n      ${"admin"===n.role?`\n        <div class="post-menu">\n          <button class="menu-btn" title="Opciones">â‹¯</button>\n          <ul class="menu-options">\n            \n            <li class="danger" onclick="deletePost(${t.id})">ğŸ—‘ï¸ Eliminar</li>\n          </ul>\n        </div>\n      `:""}\n      \n      <div class="post-media">\n        ${function(e){if(!e.image)return'<div style="display: flex; align-items: center; justify-content: center; height: 100%; background: var(--bg); color: var(--muted);">ğŸ“„ Sin imagen</div>';if("video"===e.type){if(e.image.includes("youtube.com")||e.image.includes("youtu.be")){const t=s(e.image);if(t)return`<img src="https://img.youtube.com/vi/${t}/maxresdefault.jpg" alt="${c(e.title)}" onerror="this.src='https://img.youtube.com/vi/${t}/hqdefault.jpg'" / onClick={editPost(${e.id})}>`}return`<video preload="metadata" style="object-fit: cover;"><source src="${e.image}" /></video>`}return`<img src="${e.image}" alt="${c(e.title)}" />`}(t)}\n        ${"video"===t.type?'<div class="media-overlay">ğŸ¬ Video</div>':""}\n      </div>\n      \n      <h3 class="post-title">${c(t.title)}</h3>\n      <div class="post-desc">${c((t.description||"").slice(0,150))}${t.description&&t.description.length>150?"...":""}</div>\n      \n      <div class="meta-row">\n        <div class="post-actions">\n          <button class="action-btn ${t.liked?"liked":""}" onclick="toggleLike(${t.id})">\n            â¤ï¸ ${t.likes||0}\n          </button>\n          <button class="action-btn" onclick="openPostDetail(${t.id})">\n            ğŸ’¬ Ver mÃ¡s\n          </button>\n        </div>\n        <div class="text-muted" style="font-size: 14px;">\n           ${c(t.category||"General")}\n        </div>\n      </div>\n    `;const o=i.querySelector(".menu-btn"),a=i.querySelector(".menu-options");o&&a&&o.addEventListener("click",e=>{e.stopPropagation(),document.querySelectorAll(".menu-options.show").forEach(e=>{e!==a&&e.classList.remove("show")}),a.classList.toggle("show")}),i.addEventListener("click",e=>{e.target.closest(".post-menu")||e.target.closest(".action-btn")||r(t)}),e.appendChild(i)})}function s(e){const t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return t&&11===t[7].length?t[7]:null}function r(e){const n="object"==typeof e?e:JSON.parse(localStorage.getItem("posts")||"[]").find(t=>t.id===e);n&&t(()=>import("./news-DpjAYMZB.js").then(e=>e.P),[]).then(e=>{e.openPostDetailModal(n)})}function a(e,t="success"){const n=document.createElement("div");n.className="toast-message",n.textContent=e,"error"===t&&(n.style.background="linear-gradient(135deg, var(--danger), #b91c1c)"),document.body.appendChild(n),setTimeout(()=>{n.parentNode&&(n.style.animation="slideInRight 0.3s ease-out reverse",setTimeout(()=>n.remove(),300))},3e3)}function c(e){const t=document.createElement("div");return t.textContent=e||"",t.innerHTML}window.toggleLike=function(e){const t=JSON.parse(localStorage.getItem("posts")||"[]"),n=t.findIndex(t=>t.id===e);if(-1===n)return;t[n].likes=(t[n].likes||0)+1,t[n].liked=!0,localStorage.setItem("posts",JSON.stringify(t)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({posts:t})}),localStorage.setItem("posts_update_ts",Date.now().toString()),window.dispatchEvent(new Event("app:postsUpdated"));const i=document.querySelector(`button[onclick="toggleLike(${e})"]`);i&&(i.innerHTML=`â¤ï¸ ${t[n].likes}`,i.classList.add("liked")),a("â¤ï¸ Â¡Te gusta esta publicaciÃ³n!","success")},window.editPost=function(e){const n=JSON.parse(localStorage.getItem("posts")||"[]"),i=n.find(t=>t.id===e);i&&t(()=>import("./Publish-CwwR_ava.js"),[]).then(t=>{t.renderEditPost(document.body,i,t=>{const i=n.findIndex(t=>t.id===e);-1!==i&&(n[i]=t,localStorage.setItem("posts",JSON.stringify(n)),localStorage.setItem("posts_update_ts",Date.now().toString()),window.dispatchEvent(new Event("app:postsUpdated")),a("âœ… PublicaciÃ³n actualizada","success"),setTimeout(()=>location.reload(),1e3))})})},window.deletePost=function(e){if(!confirm("Â¿EstÃ¡s seguro de que quieres eliminar esta publicaciÃ³n?"))return;const t=JSON.parse(localStorage.getItem("posts")||"[]").filter(t=>t.id!==e);localStorage.setItem("posts",JSON.stringify(t)),fetch("/api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({posts:t})}),localStorage.setItem("posts_update_ts",Date.now().toString()),window.dispatchEvent(new Event("app:postsUpdated")),a("ğŸ—‘ï¸ PublicaciÃ³n eliminada","success"),setTimeout(()=>location.reload(),1e3)};const l=Object.freeze(Object.defineProperty({__proto__:null,renderHome:n},Symbol.toStringTag,{value:"Module"}));export{l as H,t as _,n as r};
